<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>ITHub:Discussions</title>
    <link rel="icon" href="pct/114.png"/>
    <link rel="stylesheet" href="StyleSheet1.css" />
</head>

<body>
    <div class="b"></div>
    <header class="header">


        <div class="r1"></div>
        <div class="menu1">
            <div class="c3"></div>
            <a href="HTMLPage1.html">
                <img src="pct/111.png" width="150" />
            </a>
        </div>
        <div class="menu2">
            <form action="" method="get" class="sdd">

                <input name="s" type="search" class="sx" />
                <button class="search"><img src="pct/113.png" width="35" height="30" /></button>
            </form>



            <div class="dcb" style="  vertical-align:top; display:inline-block; font-family:Arial; color:blue; margin-right:10px; border:2px blue solid; height:30px; width:50px; margin-right:5px;  border-radius:8px; text-align:center;">

                <a href="Login.html" style="text-decoration:none; "><div style="height:88%; width:100%; padding-top:6px; ">  Вход</div></a>



            </div>

        </div>
    </header>
   
    <div class="a1"></div>
    
    <main>
        <div class="block-menu">
            <a href="HTMLPage1.html" style="text-decoration:none; vertical-align:middle;"><img src="pct/133.png" height="20" style="margin-right:20px; margin-top:10px;  " />Главная<div style="height:5px;"></div></a>
            <a href="questions.html" style="text-decoration: none; vertical-align: middle"><img src="pct/222.png" height="25" style="margin-right:20px; margin-top:10px;" />Вопросы<div style="height:5px;"></div></a>
            <a href="Tags.html" style="text-decoration: none; vertical-align: middle"><img src="pct/333.png" height="20" style="margin-right:20px; margin-top:10px;" />Теги<div style="height:5px;"></div></a>

            <a href="obsujd.html" style="text-decoration: none; vertical-align: middle; "><img src="pct/55.png" height="20" style="margin-right:20px; margin-top:10px;" />Обсуждения<div style="height:5px;"></div></a>
        </div>
        <div class="c6"></div>
        <div class="Container" style="height:auto; display:block; margin-bottom:20px; ">

            <div class="ddd" style="vertical-align:top;float:left; border-right:1px solid gray; width:130px; height:auto; display:inline-block; ">
                <p style="font-family: Arial;  width: auto;  padding-right: 5px; padding-left: 5px; border-bottom: 1px solid gray;">UserName</p>
                <p style="font-size: 12px; ">Дата публикации:</p>
                <p style="font-size: 12px; ">12.09.2024 19:22</p>
            </div>
            <div class="nn" style="width:80%; text-align:left; display:inline-block; vertical-align:top;">
                <a class="qsn" href="#obs1" style="text-decoration:none; color:black;"><h3 style="display:block; ">Проблема с обнаружением сервера C#</h3></a>
                <p>
                    Всем привет! При программировании сервера и клиента с помощью TcpListener и TcpClient у меня произошла ошибка.
                </p>

                <p>Как видно из кода сервера и клиента, сначала я задаю TcpListener и TcpClient по введённому IP-адресу и порту.</p>

                <p> Так вот - если я при просьбе ввести IP сервера ввожу что то кроме 127.0.0.1, то программа выдаёт:</p>

                <p>  Произошла ошибка SocketException - Требуемый адрес для своего контекста неверен.</p>
                <textarea style="display:block; width:100%; height:200px; margin-bottom:5%;  " readonly>using System.Net;
using System.Net.Sockets;

namespace Server
{
    internal class Program
    {
        static void Main(string[] args)
        {

            TcpListener tcp = null;
            try
            {
                IPAddress ip;
                int port;
                Console.WriteLine("Введите IPv4 адрес:");
                string ipAddress = Console.ReadLine().ToString();
                Console.WriteLine("Введите порт:");
                port = Convert.ToInt32(Console.ReadLine());
                ip = IPAddress.Parse(ipAddress);
                tcp = new TcpListener(ip, port);
                tcp.Start();
                Console.WriteLine($"Сервер {tcp.Server.LocalEndPoint} запущен!");

                while (true)
                {
                    Socket client = tcp.AcceptSocket();
                    Console.WriteLine($"Клиент {client.RemoteEndPoint} был подключён");
                    client.Send(Encoding.Default.GetBytes("Hello!"));

                    Console.WriteLine($"Начало работы с {client.RemoteEndPoint}:");
                    while (true)
                    {
                        string str = Console.ReadLine().ToString();
                        byte[] buffer = Encoding.Default.GetBytes(str);
                        if (str.ToLower() == "/dnt")
                        {
                            for (int i = 1; i <= 400; i++)
                                client.Send(Encoding.Default.GetBytes("=)"));
                        }
                        else if (str.ToLower() == "/exit")
                        {
                            Console.WriteLine($"Работа с {client.RemoteEndPoint} прекращена");
                        }
                        else
                        {
                            client.Send(buffer);
                        }
                    }
                }
            }
            catch (Exception e)
            {
                Console.WriteLine($"Произошла ошибка {e.GetType().Name} - {e.Message}");
            }
            finally
            {
                tcp.Dispose();
                tcp.Stop();
                Thread.Sleep(1000);
                Environment.Exit(0);
            }
        }
    }
}</textarea>

            </div>



        </div>
        <div style="height: auto; display: block; margin-left: 180px; margin-bottom:10px; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0px 1.5px 1.5px 0px rgba(0, 0, 0, 0.5);">
            Оставтье свой коментарий:
            <textarea style="display:block; width:80%; height:120px;margin-bottom:10px;"></textarea>

            <div class="jj" style="display:block; width:90px; cursor:pointer;">
                <a style="border: 1px solid grey; padding:2px;border-radius:8px; ">Отправить</a>

            </div>

        </div>
        <div class="blockvoprosov" style=" text-align: left; height: auto; border-radius: 8px; background-color: white; border-top: 2px solid gray; margin-left: 180px; margin-bottom: 10px; box-shadow: 0px 1.5px 1.5px 0px rgba(0, 0, 0, 0.5);">

            <div style="display:block; font-family:Arial; margin-left ">
                <div class="ddd" style="vertical-align:top; border-right:1px solid gray; width:130px; height:auto; display:inline-block; ">
                    <p style="font-family: Arial;  width: auto;  padding-right: 5px; padding-left: 5px; border-bottom: 1px solid gray;">UserName</p>

                    <p style="font-size: 12px; ">22.10.2024 11:40</p>
                </div>

                <div class="nn" style="width:80%; text-align:left; display:inline-block; vertical-align:central;width:70%">
                    <p>
                        что то кроме 127.0.0.1 а это что то пингуется с машины, где прогу запускаете?
                    </p>
                </div>



            </div>
        </div>
        <div class="blockvoprosov" style=" text-align: left; height: auto; border-radius: 8px; background-color: white; border-top: 2px solid gray; margin-left: 180px; margin-bottom: 10px; box-shadow: 0px 1.5px 1.5px 0px rgba(0, 0, 0, 0.5);">

            <div style="display:block; font-family:Arial; margin-left ">
                <div class="ddd" style="vertical-align:top; border-right:1px solid gray; width:130px; height:auto; display:inline-block; ">
                    <p style="font-family: Arial;  width: auto;  padding-right: 5px; padding-left: 5px; border-bottom: 1px solid gray;">UserName</p>

                    <p style="font-size: 12px; ">22.10.2024 12:43</p>
                </div>

                <div class="nn" style="width:80%; text-align:left; display:inline-block; vertical-align:central;width:70%">
                    <p>
                        Серверу адрес можно не задавать. 0.0.0.0 или IPAddress.Any. Тогда он будет слушать на всех интерфейсах. А так, вот пример ru.stackoverflow.com/a/1384651/373567 Не забудьте отключить или создать разрешающее правило в брандмауре Windows. Но винда при первом запуске сервера на порту должна сама спросить разрешение создать правило.
                    </p>
                </div>



            </div>
        </div>
    </main>

    <div class="r"></div>
    <footer style=" height:auto; margin-top:20%; ">
        <div class="e"></div>
        <div class="s"><p>©2024 ITHub.com</p></div>

    </footer>
  
</body>

</html>